<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // Function to capture parameters and modify the New Item link in the child list
        function setChildFormLink() {
            // Replace with your method to capture these values from the parent form
            var managerID = document.querySelector("[FieldInternalName='Manager_ID']").innerText;
            var manager = document.querySelector("[FieldInternalName='Manager']").innerText;
            var managerName = document.querySelector("[FieldInternalName='Manager_Name']").innerText;
            var region = document.querySelector("[FieldInternalName='Region']").innerText;
            var frequency = document.querySelector("[FieldInternalName='Frequency']").innerText;
            var vLookupParentID = document.querySelector("[FieldInternalName='vLookupParentID']").innerText;
            
            // Find the Add New Item link in the child list web part and modify the URL
            var newItemButton = document.querySelector("a[data-command='new']");
            if (newItemButton) {
                newItemButton.href = `/sites/yoursite/Lists/ChildList/NewForm.aspx?Manager_ID=${encodeURIComponent(managerID)}&Manager=${encodeURIComponent(manager)}&Manager_Name=${encodeURIComponent(managerName)}&Region=${encodeURIComponent(region)}&Frequency=${encodeURIComponent(frequency)}&vLookupParentID=${encodeURIComponent(vLookupParentID)}`;
            }
        }

        // Call the function to set the link on page load
        setChildFormLink();
    });
</script>
